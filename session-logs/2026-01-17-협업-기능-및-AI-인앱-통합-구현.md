---
title: 협업 기능 및 AI 인앱 통합 구현
date: 2026-01-17
author: Antigravity
---

# 협업 기능 및 AI 인앱 통합 구현 세션 로그

## 1. 세션 개요

본 세션에서는 바이브폴리오의 협업 기능을 강화하고, AI 도구의 접근성을 높이기 위해 마이페이지 내 인앱(In-App) 통합 작업을 수행했습니다. 또한, 피드백 시스템의 프라이버시를 강화하여 더욱 전문적이고 안전한 소통 환경을 구축했습니다.

## 2. 주요 목표

1.  **공동 제작자(Collaborator) 시스템 구축**: 프로젝트에 팀원을 초대하고, 권한 및 포트폴리오를 공유하는 기능 구현.
2.  **피드백 프라이버시 및 자동 알림**: 전문 평가(미슐랭 가이드)의 상세 내용을 관계자 외에는 숨기고, 평가 등록 시 자동 마스킹 댓글 생성.
3.  **마이페이지 AI 도구 인앱 통합**: 페이지 이동 없이 마이페이지 내에서 바로 AI 탐색기를 사용할 수 있도록 UX 개선.
4.  **사용자 재방문 유도(Retention)**: AI 탐색기의 검색 기록을 저장하고 '이어하기' 기능을 제공하여 사용자 편의성 증대.

## 3. 작업 상세 내용

### 3.1. 공동 제작자 시스템 (Collaboration)

- **데이터베이스**: `project_collaborators` 테이블을 생성하여 프로젝트 ID와 사용자 ID를 매핑했습니다.
- **권한 관리(RLS)**:
  - 공동 제작자는 해당 프로젝트에 대해 **수정(Update) 권한**을 가집니다.
  - 프로젝트 소유자만이 공동 제작자를 추가하거나 삭제할 수 있습니다.
- **UI/UX**: `CollaboratorManager` 컴포넌트를 개발하여 프로젝트 업로드/수정 페이지에서 이메일로 간편하게 팀원을 초대할 수 있도록 구현했습니다.

### 3.2. 피드백 프라이버시 및 자동 댓글

- **조회 권한 제한**: `ProjectRating` 테이블의 RLS(Row Level Security) 정책을 강화하여, **작성자 본인, 프로젝트 소유자, 공동 제작자**만 상세 평가 점수와 내용을 볼 수 있도록 설정했습니다.
- **API 개선**: `/api/projects/[id]/rating` 엔드포인트에서 권한 여부(`isAuthorized`)를 판별하여 클라이언트에 전달합니다.
- **자동 댓글 생성**: 평가가 등록되면 서버단에서 자동으로 **"\***(가림처리)님이 정성스러운 피드백을 남겼어요"\*\*라는 마스킹된 댓글을 생성하여, 내용은 보호하면서도 소통의 흔적은 남기도록 구현했습니다.

### 3.3. AI 도구 인앱 통합 (In-App Experience)

- **컴포넌트 리팩토링**: 기존 페이지 단위였던 AI 탐색기를 `AiOpportunityExplorer`라는 재사용 가능한 독립 컴포넌트로 분리했습니다.
- **인라인 뷰(Inline View)**: 마이페이지의 'AI 도구' 탭에서 "탐색기 시작하기" 버튼 클릭 시, 페이지 이동 없이 탭 내부에서 슬라이드 애니메이션과 함께 탐색기가 실행되도록 구현했습니다 (`embedded` 모드).
- **UX 개선**: 사용자가 작업 흐름을 끊지 않고 도구를 활용하고 닫을 수 있어 사용자 경험이 대폭 향상되었습니다.

### 3.4. 검색 기록 이어하기 (History & Retention)

- **데이터 활용**: 추가적인 DB 테이블 생성 없이, 기존에 쌓이던 `ai_search_logs` 테이블을 활용했습니다.
- **API 확장**: `GET /api/tools/search-opportunity` 엔드포인트를 추가하여 사용자의 최근 고유 검색어 5~7개를 중복 없이 추출하여 반환합니다.
- **UI 적용**: 탐색기 상단에 최근 검색어를 **'칩(Chip)'** 형태로 노출하여, 클릭 한 번으로 이전 작업을 바로 이어갈 수 있게 구현했습니다.

## 4. 기술적 특이사항

- **데이터 다이어트 전략**: 향후 린 캔버스 등의 도구 확장 시, 모든 편집 로그를 저장하는 대신 유저가 마지막으로 작업한 **'최종 상태(Snapshot)' 하나만 저장**하는 방식을 채택하여 DB 용량을 효율적으로 관리할 계획입니다.
- **보안**: 모든 기능은 Supabase의 RLS 정책과 Next.js 서버 사이드 API의 이중 검증을 통해 데이터 보안을 철저히 유지했습니다.

## 5. 향후 계획

- **AI 도구 확장**: 'AI 린 캔버스', '페르소나 정의' 등 다른 도구들도 동일한 인앱 방식으로 통합 예정.
- **알림 센터 연동**: 공동 제작자 초대 시 실시간 알림 발송 기능 연동 필요.
- **리팩토링**: 마이페이지(`page.tsx`)의 코드량이 증가함에 따라, 탭별 콘텐츠를 별도 컴포넌트로 분리하여 유지보수성 향상 필요.
